knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
fw <- read_csv("flights_weather.csv")
fw %>% filter(!is.na(origin)) %>% filter(!is.na(dest)) %>% select(origin, dest) %>% count(origin, dest) %>% mutate(prop = n/sum(n))
fw %>% filter(!is.na(air_time)) %>% group_by(air_time, dest) %>% summarise(media = mean(air_time)) %>% arrange(desc(media)) %>% slice(1:1)
fw %>% filter(!is.na(air_time)) %>% group_by(dest) %>% summarise(media = mean(air_time)) %>% arrange(desc(media)) %>% slice(1:1)
fw_new <- fw %>%
mutate(visibilidad = case_when(visib <= quantile(sum(visib), 0.10) ~"Nivel 1 - Baja",
visib <= quantile(sum(visib), 0.15) ~"Nivel 2 - Media",
visib > quantile(sum(visib), 0.15) ~"Nivel 1 - Alta"))
fw_new %>% distinct(visibilidad)
fw_new <- fw %>%
mutate(Visibilidad =
case_when( visib <= quantile(visib, 0.1) ~ "Nivel 1 - Baja",
visib > quantile(visib, 0.1) & visib <= quantile(visib, 0.15) ~ "Nivel 2 - Media",
visib > quantile(visib, 0.15) ~ "Nivel 3 - Alta",
) )
fw_new %>% distinct(Visibilidad)
fw1 <- fw_new %>% filter(!is.na(dep_delay)) %>% group_by(origin == 'EWR' | origin == 'JFK' | origin == 'LGA') %>% summarise(retraso = mean(dep_delay))
ggplot(fw1, aes(x = origin, y = retraso)) +
geom_bar(position = "dodge") +
labs(title = "Retraso Medio en Despegue", subtitle = "según nivel de visibilidad y aeropuerto de origen", x = "Aeropuerto de Origen", y = "Retraso Medio en Despegue (en minutos)")
fw_new %>% filter(!is.na(dep_delay)) %>%
group_by(origin, Visibilidad) %>% summarise(avg_dep_delay = mean(dep_delay)) %>%
ggplot(aes(x=origin, y=avg_dep_delay, fill=Visibilidad)) +
geom_bar(stat="identity", position="dodge") +
labs(x = "Aeropuerto de Origen", y = "Restraso Medio en Despegue (en minutos)",
title = "Retraso Medio en Despegue",
subtitle = "según nivel de visibilidad y aeropuerto de origen") + theme_minimal()
10-1-2-2.5
10-3*1.25-2.25
